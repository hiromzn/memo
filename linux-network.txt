# network config

- command line tool
  ```
  # nmtui
  ```



/etc/sysconfig/network-script
interface up / down

# nmcli connection up eno1
# nmcli connection down eno1

ip command

# ip address show
# ip a show

# ip link show
# ip l show

# ip -s link ..... show statistics info.
# ip -s l

# ip route show
# ip route
# ip r

# ip neighbour show
# ip n

### nmcli

# nmcli device

# nmcli device show eno1

# nmcli connection show eno1

IPアドレスを192.168.0.130, GWを192.168.0.1に変更
# nmcli connection modify eno1 ipv4.addresses "192.168.0.130/24 192.168.0.1"

DNSサーバを192.168.0.1と2に変更
# nmcli connection modify eno1 ipv4.dns "192.168.0.1 192.168.0.2"

StaticRouteの追加
# nmcli connection modify eno1 ipv4.routes "192.168.17.0/24 192.168.0.1"

ss command

# ss -ant

network再起動
	# systemctl restart NetworkManager

	# /etc/rc.d/init.d/network restart

ERROR:
  Bringing up Interface eth0:  Error:  No suitable device found:  no device found for connection ‘System eth0'

	# ifconfig
	.... HWaddr AA:BB:CC:DD:EE:FF

	/etc/sysconfig/network-scripts/ifcfg-eth1
		change the HWADDR parameter
		HWADDR=AA:BB:CC:DD:EE:FF

  Bringing up interface eth1:  Error: Unknown connection: 62c33d1a-a92e-4581-a7e6-2e49f06a1c3d.
    NetworkManagerの動作が関係しているかもしれない。
      # service NetworkManager stop / start

ifcfg-eth0：サンプル

Proxy:
	HPE : 2016/8/15 : http://autocache.hpecorp.net/

NetworkManager
	ネットワーク管理機能
	■サービス確認
		# chkconfig |grep NetworkManager
		NetworkManager 	  0:off	1:off	2:on	3:on	4:on	5:on	6:off
	■設定方法
		# vi /etc/sysconfig/network-scripts/ifcfg-eth0
		PEERDNS=yes
		DNS1=192.168.186.2

		# cat /etc/resolv.conf
		# Generated by NetworkManager
		nameserver 192.168.186.2

	  ※上記DNS1のエントリーがないと以下resolv.confは以下のようになる。
		# cat /etc/resolv.conf
		# Generated by NetworkManager


		# No nameservers found; try putting DNS servers into your
		# ifcfg files in /etc/sysconfig/network-scripts like so:
		#
		# DNS1=xxx.xxx.xxx.xxx
		# DNS2=xxx.xxx.xxx.xxx
		# DOMAIN=lab.foo.com bar.foo.com

forward ip packets
  enable packet forwarding
  $ cat /proc/sys/net/ipv4/ip_forward
  0

  $ vi /etc/sysctl.conf
  net.ipv4.ip_forward = 1

  $ sysctl -p /etc/sysctl.conf
  net.ipv4.ip_forward = 1
  net.ipv4.conf.all.rp_filter = 1
  net.ipv4.ip_always_defrag = 0
  kernel.sysrq = 0

  $ cat /proc/sys/net/ipv4/ip_forward
  1

ipchains ... IP firewall administration

  ipchainsの概要
    4つのcategoryがある。それぞれ、
      IP input chain
      IP output chain
      IP forwarding chain
      user-defined chain
    target
      ruleが一致した時に行なわれるアクション。
        user-defined chainの名前又は、
        ACCEPT, DENY, REJECT, MASQ, REDIRECT,
        or RETURN.

  ruleの表示
    $ ipchains -L
    Chain input (policy ACCEPT):
    Chain forward (policy ACCEPT):
    Chain output (policy ACCEPT):

  フォワードを全部禁止
    $ ipchains -P forward DENY
  フォワードを全部許可
    $ ipchains -P forward ACCEPT

  host1からport:80へのTCPを許可
    $ ipchains -D forward -p TCP -s host1 80 -j ACCEPT

  host1、port:80へのTCPを許可
    $ ipchains -D forward -p TCP -d host1 80 -j ACCEPT

###############
OLD commands:
###############

netstat -A inet -np
iptables -L

$ mii-tool      ..... list lan interface
$ ethtool eth0  ..... show lan interface
$ sysreport ......... システムデータを収集するツール
$ ifconfig -a ....... show lan info.

network config (LAN : eth0, eth1 ...etc...)
  $ /sbin/ifdown eth0

  $ cat /etc/sysconfig/network-scripts/ifcfg-eth0
  DEVICE=eth0
  BROADCAST=15.12.23.255
  IPADDR=15.12.20.34
  NETMASK=255.255.248.0
  NETWORK=15.12.16.0
  ONBOOT=yes

  $ cd /etc/sysconfig/network-scripts
  $ ./ifup eth0

host名の変更
	# hostnamectl set-hostname <new_hostname>

	# hostnamectl   ..... hostnameの確認

  $ cat /etc/sysconfig/network
  NETWORKING=yes
  HOSTNAME=xxxxxxx
  GATEWAY=192.168.0.1

  $ /etc/rc.d/init.d/network restart
